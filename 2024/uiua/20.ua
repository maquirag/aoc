# AoC 2024/20 Race Condition
# Experimental!
&fras "2024/input/20.txt"
In   â†
P    â† âˆ©âŠ¢âˆ©âŠšâŠƒ(=@S|=@E|â‰ @#) âŠœâˆ˜âŠ¸â‰ @\n           # start end map
Walk â† âŠ¢path(â–½â¤šâŠ¡+âŒŸAâ‚‚âŠ™â‹…âˆ˜)â‰                   # optimum path
Bâ€¼   â† â‰¡âŒŸ(-â‚‚âŒµ-âˆ©âŒŸgetâŠƒ(âˆ˜|+^1 0_2)) âŠšâŒ•^0 1_0_1 # bridges
First â† (
  :ğ„ˆmapÂ°âŠ âŠ¸Walk P    # path coord to step
  â†âŠ‚âŠƒBâ€¼âˆ˜âˆ˜ Bâ€¼(â†¯3_1|â‡Œ) # horiz and vert diff
  /+â‰¥100             # count over threshold
)
First In # works but not generalized...

MD â† /+âŒµ- # Manhattan Distance
Cheat! â† (
  â§…â‚‚<â‡¡âŠ¸â§»               # unique index pairs
  â–½âŠ¸â‰¡(â‰¥80âŒµ/-)          # narrow down on min distance (ARBITRARY)
  waitâ¤šâ‰¡âŒŸpool(MDâˆ©âŒŸâŠ¡Â°âŠŸ) # manhattan distances and path indices
  âˆ©âŒâ–½âŠ¸^0               # filter on MD
  -âŠ™â‰¡(âŒµ/-)             # differece of path indices
  â–½âŠ¸â‰¥100               # filter savings
  âŠƒ(â§»|âŠŸÂ°â–½â‡Œâ†)           # evaluate
)
Partâ‚ â† Cheat!(=2) Walk P
Partâ‚‚ â† Cheat!(â‰¤20) Walk P
# âœ(now|Partâ‚ In) # fail, too slow
# âœ(now|Partâ‚‚ In) # fail, too slow

Draw â† (
  â–½âŸœâ‰¡â–½5 â¬š0â†¥Â°âŠš âŠ™(Ã—0.5) âŠ¸Walk P In
  &fwa "2024/uiua/20path.gif" img "gif"
) # draw the map to gif
